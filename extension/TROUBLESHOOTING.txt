Extension Troubleshooting Quick Guide
=====================================

If you see "Native host disconnection error" in the console:

1. Check Extension ID Configuration:
   - Go to chrome://extensions
   - Copy your extension ID (looks like: abcdefghijklmnopqrstuvwxyz123456)
   - Edit: ~/.config/google-chrome/NativeMessagingHosts/com.agent_tasks.bridge.json
   - Replace EXTENSION_ID_PLACEHOLDER with your actual ID
   - Save and reload extension

2. Verify agent-bridge is installed:
   $ which agent-bridge
   Should show: /usr/local/bin/agent-bridge

   If not found:
   $ cd /path/to/agent-notifications
   $ cargo build --release --bin agent-bridge
   $ sudo cp target/release/agent-bridge /usr/local/bin/

3. Test agent-bridge manually:
   $ echo '{"type":"task_update","task_id":"test","agent_type":"test","status":"running","title":"test","context":{}}' | agent-bridge

   Should see in stderr: "agent-bridge started"

4. Check manifest file:
   $ cat ~/.config/google-chrome/NativeMessagingHosts/com.agent_tasks.bridge.json

   Should contain:
   - Correct path to agent-bridge (/usr/local/bin/agent-bridge)
   - Your extension ID (not EXTENSION_ID_PLACEHOLDER)

5. Reload extension:
   - Go to chrome://extensions
   - Click reload button on "Agent Inbox Tracker"
   - Open background console: click "background page"
   - Should see: "Connected to native host: com.agent_tasks.bridge"

Common Issues:
--------------

Issue: "Specified native messaging host not found"
Fix: Install manifest to correct location:
     ~/.config/google-chrome/NativeMessagingHosts/  (Chrome)
     ~/.mozilla/native-messaging-hosts/             (Firefox)

Issue: "Native host has exited"
Fix: Check agent-bridge has execute permissions:
     $ chmod +x /usr/local/bin/agent-bridge

Issue: Extension ID still showing PLACEHOLDER
Fix: You must manually edit the manifest file and insert your real extension ID

Issue: Extension loads but doesn't track conversations
Fix: 1. Check content script loaded (F12 on Claude.ai, look for console message)
     2. Refresh the page
     3. Check background console for errors
